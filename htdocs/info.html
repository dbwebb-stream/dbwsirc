<!doctype html>
<html>

<head>
  <meta charset="utf-8" />
  <!-- Mobile -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
  <title>Putte info</title>

  <style>
    body {
      font-family: monospace;
    }

    ul {
      list-style: none;
    }
  </style>

</head>

<body>
  <div id="message-display">
    <!-- <h2>Bot Settings</h2> -->

    <h2>Latest</h2>
    <p>{{ formatedMessage }}</p>

    <h2>Raw feed</h2>
    <ul id="messages">
      <li v-for="message in messages" track-by="$index">{{ message }}</li>
    </ul>

  </div>

  <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.28/vue.js" type="text/javascript"></script>

  <script type="text/javascript">
    var socket = io()

    var formatMessage = ({ from, to, message }) =>
      `${from} => ${to}\n${message}`

    new Vue({
      el: '#message-display',

      data: {
        formatedMessage: '',
        message: '',
        messages: []
      },

      ready: function () {
        socket.on('message', (message) => {
          this.messages.push(JSON.stringify(message) || message || 'error in message');
          this.formatedMessage = formatMessage(message)
        })

        socket.on('disconnect', (message) => {
          this.messages.push('< The server disconnected >');
        })

        socket.on('connect', (message) => {
          this.messages.push('< Connected to server >');
        })
      },
    })
  </script>

</body>

</html>
